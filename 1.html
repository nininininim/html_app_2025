<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë¸”ë™ì­ ê²Œì„</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #115c2b; /* ì§„í•œ ì´ˆë¡ìƒ‰ */
            color: #fff;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        h1 {
            margin-top: 40px;
            font-size: 2.5em;
            color: #ffd700;
        }
        .game-area {
            background: #333;
            border-radius: 16px;
            box-shadow: 0 4px 24px #0008;
            padding: 32px 24px;
            margin-top: 32px;
            min-width: 340px;
            max-width: 400px;
        }
        .cards {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }
        .card {
            background: #fff;
            color: #222;
            border-radius: 8px;
            width: 48px;
            height: 72px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            font-weight: bold;
            box-shadow: 0 2px 8px #0004;
        }
        .score {
            font-size: 1.1em;
            margin-bottom: 12px;
        }
        .actions {
            display: flex;
            gap: 16px;
            margin-top: 16px;
        }
        button {
            background: #ffd700;
            color: #222;
            border: none;
            border-radius: 6px;
            padding: 10px 24px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
        }
        button:active {
            background: #e6c200;
        }
        .result {
            font-size: 1.2em;
            margin-top: 18px;
            color: #ff5252;
        }
    </style>
</head>
<body>
    <h1>ë¸”ë™ì­ ê²Œì„</h1>
    <div class="game-area">
        <div>
            <strong>ë”œëŸ¬ ì¹´ë“œ</strong>
            <div class="cards" id="dealer-cards"></div>
            <div class="score" id="dealer-score"></div>
        </div>
        <hr>
        <!-- 3ëª…ì˜ í”Œë ˆì´ì–´ ì˜ì—­ ì¶”ê°€ -->
        <div id="players-area">
            <div>
                <strong>í”Œë ˆì´ì–´ 1 ì¹´ë“œ</strong>
                <div class="cards" id="player1-cards"></div>
                <div class="score" id="player1-score"></div>
                <div class="actions" id="player1-actions"></div>
            </div>
            <hr>
            <div>
                <strong>í”Œë ˆì´ì–´ 2 ì¹´ë“œ</strong>
                <div class="cards" id="player2-cards"></div>
                <div class="score" id="player2-score"></div>
                <div class="actions" id="player2-actions"></div>
            </div>
            <hr>
            <div>
                <strong>í”Œë ˆì´ì–´ 3 ì¹´ë“œ</strong>
                <div class="cards" id="player3-cards"></div>
                <div class="score" id="player3-score"></div>
                <div class="actions" id="player3-actions"></div>
            </div>
        </div>
        <div class="result" id="result"></div>
        <div style="margin-top:16px;">
            <button id="restart">ë‹¤ì‹œí•˜ê¸°</button>
        </div>
    </div>
    <script>
        // ì¹´ë“œ ë± ìƒì„±
        const suits = ['â™ ', 'â™¥', 'â™¦', 'â™£'];
        const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        function createDeck() {
            const deck = [];
            for (let suit of suits) {
                for (let value of values) {
                    deck.push({suit, value});
                }
            }
            return deck;
        }
        function shuffle(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }
        // 3ëª…ì˜ í”Œë ˆì´ì–´ ì§€ì›
        let deck, dealerCards, players, currentPlayer, gameOver;

        function startGame() {
            deck = createDeck();
            shuffle(deck);
            dealerCards = [deck.pop(), deck.pop()];
            players = [
                {cards: [deck.pop(), deck.pop()], stand: false, bust: false, blackjack: false, aceChoice: []},
                {cards: [deck.pop(), deck.pop()], stand: false, bust: false, blackjack: false, aceChoice: []},
                {cards: [deck.pop(), deck.pop()], stand: false, bust: false, blackjack: false, aceChoice: []}
            ];
            currentPlayer = 0;
            gameOver = false;
            document.getElementById('result').textContent = '';
            updateUI();
        }

        // A(ì—ì´ìŠ¤) ì„ íƒ UI ìƒì„±
        function showAceChoice(playerIdx, cardIdx) {
            const actionsDiv = document.getElementById(`player${playerIdx+1}-actions`);
            actionsDiv.innerHTML = '';
            const btn1 = document.createElement('button');
            btn1.textContent = 'Aë¥¼ 1ë¡œ';
            btn1.onclick = () => {
                players[playerIdx].aceChoice[cardIdx] = 1;
                updateUI();
            };
            const btn11 = document.createElement('button');
            btn11.textContent = 'Aë¥¼ 11ë¡œ';
            btn11.onclick = () => {
                players[playerIdx].aceChoice[cardIdx] = 11;
                updateUI();
            };
            actionsDiv.appendChild(btn1);
            actionsDiv.appendChild(btn11);
        }

        // ì¹´ë“œ ê°’ ê³„ì‚° (A ì„ íƒ ë°˜ì˜)
        function cardValue(card, aceChoice) {
            if (card.value === 'A') {
                return aceChoice ? aceChoice : 11;
            }
            if (['K', 'Q', 'J'].includes(card.value)) return 10;
            return parseInt(card.value);
        }
        function calculateScore(cards, aceChoices) {
            let score = 0;
            let aces = 0;
            for (let i = 0; i < cards.length; i++) {
                const card = cards[i];
                if (card.value === 'A') {
                    score += cardValue(card, aceChoices[i]);
                    aces++;
                } else {
                    score += cardValue(card);
                }
            }
            // ê¸°ì¡´ ìë™ A ì²˜ë¦¬ ì œê±° (ì§ì ‘ ì„ íƒ)
            return score;
        }

        function updateUI() {
            // ë”œëŸ¬ ì¹´ë“œ í‘œì‹œ
            const dealerCardsDiv = document.getElementById('dealer-cards');
            dealerCardsDiv.innerHTML = '';
            dealerCards.forEach((card, idx) => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'card';
                if (!gameOver && idx === 0 && players.some(p=>!p.stand && !p.bust)) {
                    cardDiv.textContent = 'ğŸ‚ '; // ì²« ì¹´ë“œ ìˆ¨ê¹€
                } else {
                    cardDiv.textContent = card.value + card.suit;
                }
                dealerCardsDiv.appendChild(cardDiv);
            });
            // ë”œëŸ¬ ì ìˆ˜ í‘œì‹œ
            const dealerScoreDiv = document.getElementById('dealer-score');
            if (!gameOver && players.some(p=>!p.stand && !p.bust)) {
                dealerScoreDiv.textContent = 'ì ìˆ˜: ?';
            } else {
                dealerScoreDiv.textContent = 'ì ìˆ˜: ' + calculateScore(dealerCards, []);
            }
            // ê° í”Œë ˆì´ì–´ UI
            for (let i = 0; i < 3; i++) {
                const player = players[i];
                const playerCardsDiv = document.getElementById(`player${i+1}-cards`);
                playerCardsDiv.innerHTML = '';
                player.cards.forEach((card, idx) => {
                    const cardDiv = document.createElement('div');
                    cardDiv.className = 'card';
                    cardDiv.textContent = card.value + card.suit;
                    playerCardsDiv.appendChild(cardDiv);
                });
                // ì ìˆ˜ í‘œì‹œ
                document.getElementById(`player${i+1}-score`).textContent =
                    'ì ìˆ˜: ' + calculateScore(player.cards, player.aceChoice);

                // ì•¡ì…˜ ë²„íŠ¼
                const actionsDiv = document.getElementById(`player${i+1}-actions`);
                actionsDiv.innerHTML = '';
                if (gameOver || player.stand || player.bust) continue;
                if (currentPlayer === i) {
                    // A ì„ íƒì´ í•„ìš”í•œ ì¹´ë“œê°€ ìˆìœ¼ë©´ ì„ íƒ UI
                    let aceIdx = player.cards.findIndex((c, idx) => c.value === 'A' && player.aceChoice[idx] == null);
                    if (aceIdx !== -1) {
                        showAceChoice(i, aceIdx);
                    } else {
                        // íˆíŠ¸/ìŠ¤íƒ ë“œ ë²„íŠ¼
                        const hitBtn = document.createElement('button');
                        hitBtn.textContent = 'íˆíŠ¸';
                        hitBtn.onclick = function() {
                            player.cards.push(deck.pop());
                            player.aceChoice.push(undefined);
                            updateUI();
                            checkGameEnd();
                        };
                        const standBtn = document.createElement('button');
                        standBtn.textContent = 'ìŠ¤íƒ ë“œ';
                        standBtn.onclick = function() {
                            player.stand = true;
                            nextPlayer();
                        };
                        actionsDiv.appendChild(hitBtn);
                        actionsDiv.appendChild(standBtn);
                    }
                }
            }
        }

        function checkGameEnd() {
            const player = players[currentPlayer];
            const score = calculateScore(player.cards, player.aceChoice);
            if (score > 21) {
                player.bust = true;
                player.stand = true;
                nextPlayer();
                return;
            }
            if (score === 21 && player.cards.length === 2) {
                player.blackjack = true;
                player.stand = true;
                nextPlayer();
                return;
            }
            updateUI();
        }

        function nextPlayer() {
            // ë‹¤ìŒ í”Œë ˆì´ì–´ë¡œ ì´ë™
            currentPlayer++;
            if (currentPlayer >= players.length) {
                dealerTurn();
            } else {
                updateUI();
            }
        }

        function dealerTurn() {
            // ëª¨ë“  í”Œë ˆì´ì–´ê°€ ëë‚˜ë©´ ë”œëŸ¬ í„´
            let dealerScore = calculateScore(dealerCards, []);
            while (dealerScore < 17) {
                dealerCards.push(deck.pop());
                dealerScore = calculateScore(dealerCards, []);
            }
            gameOver = true;
            updateUI();
            setTimeout(() => {
                showResult();
            }, 800);
        }

        function showResult() {
            const dealerScore = calculateScore(dealerCards, []);
            let resultText = '';
            for (let i = 0; i < 3; i++) {
                const player = players[i];
                const score = calculateScore(player.cards, player.aceChoice);
                let result = '';
                if (player.bust) {
                    result = `í”Œë ˆì´ì–´ ${i+1}: ë²„ìŠ¤íŠ¸! ë”œëŸ¬ ìŠ¹ë¦¬`;
                } else if (player.blackjack) {
                    result = `í”Œë ˆì´ì–´ ${i+1}: ë¸”ë™ì­! ìŠ¹ë¦¬`;
                } else if (dealerScore > 21) {
                    result = `í”Œë ˆì´ì–´ ${i+1}: ë”œëŸ¬ ë²„ìŠ¤íŠ¸! ìŠ¹ë¦¬`;
                } else if (score > dealerScore) {
                    result = `í”Œë ˆì´ì–´ ${i+1}: ìŠ¹ë¦¬!`;
                } else if (score === dealerScore) {
                    result = `í”Œë ˆì´ì–´ ${i+1}: ë¬´ìŠ¹ë¶€`;
                } else {
                    result = `í”Œë ˆì´ì–´ ${i+1}: ë”œëŸ¬ ìŠ¹ë¦¬`;
                }
                resultText += result + '\n';
            }
            document.getElementById('result').textContent = resultText;
        }

        document.getElementById('restart').onclick = function() {
            startGame();
        };

        // ìµœì´ˆ ì‹œì‘
        startGame();
    </script>
</body>
</html>
